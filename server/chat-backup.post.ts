export default defineEventHandler(async (event) => {
  try {
    const { message } = await readBody(event)
    
    if (!message) {
      return { error: '–ù—É–∂–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ' }
    }

    // –£–ª—É—á—à–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –¥–ª—è –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞
    const responses = {
      '–∫—Ä–∞–Ω': `üîß –†–µ–º–æ–Ω—Ç –ø—Ä–æ—Ç–µ–∫–∞—é—â–µ–≥–æ –∫—Ä–∞–Ω–∞ –Ω–∞ –∫—É—Ö–Ω–µ

–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞:
‚Ä¢ –ü–µ—Ä–µ–∫—Ä–æ–π—Ç–µ –≤–æ–¥—É –Ω–∞ –≤–µ–Ω—Ç–∏–ª—è—Ö –ø–æ–¥ —Ä–∞–∫–æ–≤–∏–Ω–æ–π
‚Ä¢ –û—Ç–∫—Ä–æ–π—Ç–µ –∫—Ä–∞–Ω, —á—Ç–æ–±—ã —Å–ª–∏—Ç—å –æ—Å—Ç–∞—Ç–æ–∫ –≤–æ–¥—ã
‚Ä¢ –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (–¥–æ—Å—Ç—É–ø–Ω—ã –≤ –¢–µ—Ö–Ω–æ–¥–æ–º/–ú–µ–ª–æ–º–∞–Ω –∑–∞ 1500-3000 ‚Ç∏)

–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:
‚Ä¢ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–∫—É–¥–∞ —Ç–µ—á–µ—Ç: –∏–∑ –Ω–æ—Å–∏–∫–∞, —Ä—É—á–∫–∏ –∏–ª–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
‚Ä¢ –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ç–∏–ø –∫—Ä–∞–Ω–∞: –æ–¥–Ω–æ—Ä—ã—á–∞–∂–Ω—ã–π –∏–ª–∏ –¥–≤—É—Ö–≤–µ–Ω—Ç–∏–ª—å–Ω—ã–π

–†–µ–º–æ–Ω—Ç:
‚Ä¢ –°–Ω–∏–º–∏—Ç–µ –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –∫–æ–ª–ø–∞—á–æ–∫
‚Ä¢ –û—Ç–∫—Ä—É—Ç–∏—Ç–µ —Ñ–∏–∫—Å–∏—Ä—É—é—â–∏–π –≤–∏–Ω—Ç
‚Ä¢ –ó–∞–º–µ–Ω–∏—Ç–µ –∫–∞—Ä—Ç—Ä–∏–¥–∂ (—Å—Ç–æ–∏–º–æ—Å—Ç—å 2000-4000 ‚Ç∏)
‚Ä¢ –°–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞—Ç–Ω–æ

–ü—Ä–æ–≤–µ—Ä–∫–∞:
‚Ä¢ –í–∫–ª—é—á–∏—Ç–µ –≤–æ–¥—É –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ
‚Ä¢ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞ –ø—Ä–æ—Ç–µ—á–∫–∏

üí° –°–æ–≤–µ—Ç: –ï—Å–ª–∏ –∫—Ä–∞–Ω —Å—Ç–∞—Ä—à–µ 10 –ª–µ—Ç - –ª—É—á—à–µ –∑–∞–º–µ–Ω–∏—Ç—å —Ü–µ–ª–∏–∫–æ–º (–Ω–æ–≤—ã–π —Å–º–µ—Å–∏—Ç–µ–ª—å 5000-15000 ‚Ç∏)`,

      '—Ä–æ–∑–µ—Ç–∫–∞': `‚ö° –ü—Ä–æ–±–ª–µ–º—ã —Å —Ä–æ–∑–µ—Ç–∫–æ–π - —Ä–µ—à–µ–Ω–∏–µ

–í–∞–∂–Ω–æ: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—Ä–µ–∂–¥–µ –≤—Å–µ–≥–æ!

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –ê–≤—Ç–æ–º–∞—Ç—ã –≤ —ç–ª–µ–∫—Ç—Ä–æ—â–∏—Ç–∫–µ
2. –î—Ä—É–≥–∏–µ —Ä–æ–∑–µ—Ç–∫–∏ –≤ –∫–æ–º–Ω–∞—Ç–µ
3. –°–∞–º—É —Ä–æ–∑–µ—Ç–∫—É –Ω–∞ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è

–ï—Å–ª–∏ —Ä–µ—à–∏–ª–∏ –∑–∞–º–µ–Ω–∏—Ç—å:
‚Ä¢ –ö—É–ø–∏—Ç–µ –Ω–æ–≤—É—é —Ä–æ–∑–µ—Ç–∫—É (700-2500 ‚Ç∏)
‚Ä¢ –û—Ç–∫–ª—é—á–∏—Ç–µ —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ –≤ —â–∏—Ç–∫–µ
‚Ä¢ –ê–∫–∫—É—Ä–∞—Ç–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–æ–≤—É—é —Ä–æ–∑–µ—Ç–∫—É
‚Ä¢ –í–∫–ª—é—á–∏—Ç–µ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ

üè™ –ì–¥–µ –∫—É–ø–∏—Ç—å –≤ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–µ:
‚Ä¢ –¢–µ—Ö–Ω–æ–¥–æ–º, –ú–µ–ª–æ–º–∞–Ω - —ç–ª–µ–∫—Ç—Ä–æ—Ç–æ–≤–∞—Ä—ã
‚Ä¢ –°—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–µ —Ä—ã–Ω–∫–∏

üë∑ –í—ã–∑–æ–≤ —ç–ª–µ–∫—Ç—Ä–∏–∫–∞: 4000-10000 ‚Ç∏`,

      '–¥—É—Ö–æ–≤–∫–∞': `üßº –ß–∏—Å—Ç–∫–∞ –¥—É—Ö–æ–≤–∫–∏ –æ—Ç –∂–∏—Ä–∞

–°—Ä–µ–¥—Å—Ç–≤–∞ (500-2000 ‚Ç∏):
‚Ä¢ –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –≥–µ–ª–∏ –¥–ª—è –¥—É—Ö–æ–≤–æ–∫
‚Ä¢ –≠–∫–æ-–≤–∞—Ä–∏–∞–Ω—Ç—ã: —Å–æ–¥–∞ + —É–∫—Å—É—Å

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:
1. –ù–∞–Ω–µ—Å–∏—Ç–µ —Å—Ä–µ–¥—Å—Ç–≤–æ –Ω–∞ –≤—Å–µ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏
2. –û—Å—Ç–∞–≤—å—Ç–µ –Ω–∞ 1-2 —á–∞—Å–∞
3. –ü—Ä–æ—Ç—Ä–∏—Ç–µ –∂–µ—Å—Ç–∫–æ–π –≥—É–±–∫–æ–π
4. –ü—Ä–æ–º–æ–π—Ç–µ –≤–æ–¥–æ–π
5. –í—ã—Ç—Ä–∏—Ç–µ –Ω–∞—Å—É—Ö–æ

üè™ –ú–∞–≥–∞–∑–∏–Ω—ã:
‚Ä¢ –ú–∞–≥–Ω—É–º, Small - –±—ã—Ç–æ–≤–∞—è —Ö–∏–º–∏—è
‚Ä¢ –•–æ–∑—Ç–æ–≤–∞—Ä—ã –≤ –ª—é–±–æ–º —Å—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç–µ

üí° –õ–∞–π—Ñ—Ö–∞–∫: –†–µ–≥—É–ª—è—Ä–Ω–æ —á–∏—Å—Ç–∏—Ç–µ –ø–æ—Å–ª–µ –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è –ø–∏—â–∏`,

      '–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è': `üì¶ –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –º–∞–ª–µ–Ω—å–∫–æ–π –ø—Ä–∏—Ö–æ–∂–µ–π

–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ:
‚Ä¢ –ù–∞—Å—Ç–µ–Ω–Ω—ã–µ –ø–æ–ª–∫–∏ (2000-5000 ‚Ç∏)
‚Ä¢ –ö—Ä—é—á–∫–∏ –¥–ª—è –æ–¥–µ–∂–¥—ã (500-1500 ‚Ç∏)
‚Ä¢ –í–µ—à–∞–ª–∫–∏-—Å—Ç–æ–π–∫–∏ (3000-8000 ‚Ç∏)

–£–º–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:
‚Ä¢ –û—Ä–≥–∞–Ω–∞–π–∑–µ—Ä—ã –¥–ª—è –æ–±—É–≤–∏ (1000-3000 ‚Ç∏)
‚Ä¢ –ü—É—Ñ–∏–∫ —Å –º–µ—Å—Ç–æ–º –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è (5000-15000 ‚Ç∏)
‚Ä¢ –ó–µ—Ä–∫–∞–ª–æ —Å –ø–æ–ª–æ—á–∫–æ–π (4000-10000 ‚Ç∏)

–ú–∞–≥–∞–∑–∏–Ω—ã –≤ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–µ:
‚Ä¢ –ú–µ–±–µ–ª—å: –ò–∫–µ–∞, –ú–µ–±–µ–ª—å –•–æ–ª–ª
‚Ä¢ –•–æ–∑—Ç–æ–≤–∞—Ä—ã: –î–∂—É–º, –°—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç—ã

–°–æ–≤–µ—Ç—ã:
‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –Ω–∞–¥ –¥–≤–µ—Ä—å—é
‚Ä¢ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∫—Ä—é—á–∫–∏ –Ω–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é —Å—Ç–æ—Ä–æ–Ω—É –¥–≤–µ—Ä–∏
‚Ä¢ –ü—Ä–∏–æ–±—Ä–µ—Ç–∏—Ç–µ –∫–æ–º–ø–∞–∫—Ç–Ω—É—é –±–∞–Ω–∫–µ—Ç–∫—É`
    }

    const lowerMessage = message.toLowerCase()
    let response = '–ü—Ä–∏–≤–µ—Ç! –Ø –ø–æ–º–æ–≥—É —Ä–µ—à–∏—Ç—å –≤–∞—à—É –±—ã—Ç–æ–≤—É—é –ø—Ä–æ–±–ª–µ–º—É. –û–ø–∏—à–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–µ–µ, —á—Ç–æ —Å–ª—É—á–∏–ª–æ—Å—å, –∏ —è –¥–∞–º –ø—Ä–∞–∫—Ç–∏—á–Ω—ã–π —Å–æ–≤–µ—Ç —Å —Ü–µ–Ω–∞–º–∏ –≤ —Ç–µ–Ω–≥–µ.'

    for (const [key, answer] of Object.entries(responses)) {
      if (lowerMessage.includes(key)) {
        response = answer
        break
      }
    }

    // –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ AI
    await new Promise(resolve => setTimeout(resolve, 800))

    return {
      message: response,
      model: 'local/assistant'
    }

  } catch (error: any) {
    return {
      error: '–í—Ä–µ–º–µ–Ω–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å —Å–µ—Ä–≤–µ—Ä–æ–º'
    }
  }
})